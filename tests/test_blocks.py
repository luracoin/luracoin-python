from luracoin.blocks import Block


def test_block_ids(block1, block2):  # type: ignore
    assert block1.id == (
        "e19cc16982ee3df6ceee812c373a7b70a13ef59e8239290ba18480f9d7432899"
    )

    assert block2.id == (
        "5900689f11787b424d91de931f761f888d567b6165150e6c484c344699f03ec7"
    )


def test_block_serialize(block1, block2):  # type: ignore
    assert block1.serialize() == (
        "ba77d89f010000000000000000000000000000000000000000000000000000000000"
        "000000000000e19cc16982ee3df6ceee812c373a7b70a13ef59e8239290ba18480f9"
        "d743289918000000e4f98359a9859a00000001010001000000000000000000000000"
        "0000000000000000000000000000000000000000ffffffff0100000000003005ed0b"
        "2000000003476a91500ff7ff008512170c57980f447dc24f5c52e2df03c88ac002f6"
        "859000000003476a915003ea6275ba0c6860ce74727f72617883099961a4388ac006"
        "5cd1d000000003476a91500785211d22e8c5c6bad7410b9baf99dac866a447f88ac"
    )

    assert block2.serialize() == (
        "ba77d89f010000000000000000000000000000000000000000000000000000000000"
        "0000000000005900689f11787b424d91de931f761f888d567b6165150e6c484c3446"
        "99f03ec718000000e4f98359a9859a00000006010001000000000000000000000000"
        "0000000000000000000000000000000000000000ffffffff011000000000100f2052"
        "a010000003476a915008d3f74c5f4b7b9d3193a950986a9a16decb4155088ac01000"
        "146914795faa733b4beee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcddec1000"
        "000000100000000001d0090000000000003476a915002fb168b47d7cb54b07c7a4c4"
        "f7c005811f0a775d88ac01000146914795faa733b4beee8f7fa4e2e7522f4d9d533d"
        "1fb7cd252e0d379dcddec100000000010000000000180969800000000003476a9150"
        "0d00b433df737fd3da4b2551a356d556206f2e60788ac01000146914795faa733b4b"
        "eee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcddec1000000000100000000001"
        "00c2eb0b000000003476a915002a35a40188d3ca15da2cb5ac43c5f3add8c64b1688"
        "ac01000146914795faa733b4beee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcd"
        "dec100000000010000000000130c80700000000003476a91500785211d22e8c5c6ba"
        "d7410b9baf99dac866a447f88ac01000146914795faa733b4beee8f7fa4e2e7522f4"
        "d9d533d1fb7cd252e0d379dcddec101000000010000000000130c807000000000034"
        "76a9150044d27de0e2f8e87f26beaf3cc727f1a642a09af388ac"
    )


def test_block_deserialize(block1, block2):  # type: ignore
    block = Block()

    block.deserialize(
        "ba77d89f010000000000000000000000000000000000000000000000000000000000"
        "0000000000005900689f11787b424d91de931f761f888d567b6165150e6c484c3446"
        "99f03ec718000000e4f98359a9859a00000006010001000000000000000000000000"
        "0000000000000000000000000000000000000000ffffffff011000000000100f2052"
        "a010000003476a915008d3f74c5f4b7b9d3193a950986a9a16decb4155088ac01000"
        "146914795faa733b4beee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcddec1000"
        "000000100000000001d0090000000000003476a915002fb168b47d7cb54b07c7a4c4"
        "f7c005811f0a775d88ac01000146914795faa733b4beee8f7fa4e2e7522f4d9d533d"
        "1fb7cd252e0d379dcddec100000000010000000000180969800000000003476a9150"
        "0d00b433df737fd3da4b2551a356d556206f2e60788ac01000146914795faa733b4b"
        "eee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcddec1000000000100000000001"
        "00c2eb0b000000003476a915002a35a40188d3ca15da2cb5ac43c5f3add8c64b1688"
        "ac01000146914795faa733b4beee8f7fa4e2e7522f4d9d533d1fb7cd252e0d379dcd"
        "dec100000000010000000000130c80700000000003476a91500785211d22e8c5c6ba"
        "d7410b9baf99dac866a447f88ac01000146914795faa733b4beee8f7fa4e2e7522f4"
        "d9d533d1fb7cd252e0d379dcddec101000000010000000000130c807000000000034"
        "76a9150044d27de0e2f8e87f26beaf3cc727f1a642a09af388ac"
    )

    assert block.version == block2.version
    assert block.timestamp == block2.timestamp
    assert block.bits == block2.bits
    assert block.nonce == block2.nonce
    assert block.prev_block_hash == block2.prev_block_hash
    assert block.id == block2.id
    
    block = Block()

    block.deserialize(
        "ba77d89f010000000000000000000000000000000000000000000000000000000000"
        "000000000000e19cc16982ee3df6ceee812c373a7b70a13ef59e8239290ba18480f9"
        "d743289918000000e4f98359a9859a00000001010001000000000000000000000000"
        "0000000000000000000000000000000000000000ffffffff0100000000003005ed0b"
        "2000000003476a91500ff7ff008512170c57980f447dc24f5c52e2df03c88ac002f6"
        "859000000003476a915003ea6275ba0c6860ce74727f72617883099961a4388ac006"
        "5cd1d000000003476a91500785211d22e8c5c6bad7410b9baf99dac866a447f88ac"
    )

    assert block.version == block1.version
    assert block.timestamp == block1.timestamp
    assert block.bits == block1.bits
    assert block.nonce == block1.nonce
    assert block.prev_block_hash == block1.prev_block_hash
    assert block.id == block1.id
